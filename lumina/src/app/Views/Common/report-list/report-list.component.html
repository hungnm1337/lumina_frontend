<div class="flex flex-col md:flex-row gap-4 p-4 md:p-6 h-[calc(100vh-4rem)]">
	  <!-- Left: Filters + List -->
	  <div class="bg-white rounded-lg shadow-sm p-4 flex flex-col"
		  [ngClass]="{ 'md:w-1/3': selectedReport, 'lg:w-1/4': selectedReport, 'w-full': !selectedReport }">
		<h3 class="text-lg font-semibold mb-3">Reports</h3>

		<!-- Filters -->
		<div class="space-y-2 mb-3">
			<div class="flex items-center space-x-2">
				<label class="text-sm">Status:</label>
				<select class="form-select rounded-md border px-2 py-1 text-sm" [(ngModel)]="statusFilter" (change)="applyFilter()">
					<option value="all">All</option>
					<option value="unreplied">Unreplied</option>
					<option value="replied">Replied</option>
				</select>
			</div>

			<div class="flex items-center space-x-2">
				<label class="text-sm">Sort:</label>
				<select class="form-select rounded-md border px-2 py-1 text-sm" [(ngModel)]="sortDirection" (change)="applyFilter()">
					<option value="newest">Newest first</option>
					<option value="oldest">Oldest first</option>
				</select>
			</div>

			<div class="text-sm text-gray-600">Date range</div>
			<div class="flex space-x-2">
				<input type="date" class="w-1/2 rounded-md border p-1 text-sm" [(ngModel)]="dateFrom" (change)="applyFilter()" />
				<input type="date" class="w-1/2 rounded-md border p-1 text-sm" [(ngModel)]="dateTo" (change)="applyFilter()" />
			</div>

			<div class="flex space-x-2">
				<button class="flex-1 bg-gray-100 px-3 py-1 rounded-md text-sm" (click)="dateFrom=''; dateTo=''; applyFilter()">Clear dates</button>
				<button class="flex-1 bg-blue-600 text-white px-3 py-1 rounded-md text-sm" (click)="loadReports()">Refresh</button>
			</div>
		</div>

		<!-- List -->
		<div class="flex-1 overflow-auto">
			<ul class="space-y-2">
				<li *ngFor="let r of filteredReports" (click)="selectReport(r)" class="cursor-pointer p-3 rounded-lg hover:shadow-md transition-all flex items-start space-x-3" [class.border-l-4]="true" [class.border-green-500]="r.replyAt" [class.border-red-400]="!r.replyAt">
					<div class="flex-1">
						<div class="flex justify-between items-center">
							<div class="font-medium">{{ r.title }}</div>
							<div class="text-xs text-gray-400">{{ r.sendAt | date:'short' }}</div>
						</div>
						<div class="text-sm text-gray-600 truncate">{{ r.content }}</div>
						<div class="text-xs text-gray-400 mt-1">Type: {{ r.type }}</div>
					</div>
				</li>
			</ul>
		</div>
	</div>

	<!-- Right: Detail (render only when selected) -->
	<div *ngIf="selectedReport" class="md:flex-1 relative">
		<div class="absolute inset-0 bg-white rounded-lg shadow-md p-4 transform transition-transform duration-300 translate-x-0">
			<div class="h-full flex flex-col">
				<div class="flex items-start justify-between">
					<div>
						<h2 class="text-xl font-semibold">{{ selectedReport.title }}</h2>
						<div class="text-sm text-gray-500">From: {{ selectedReport.sendBy }} • {{ selectedReport.sendAt | date:'medium' }}</div>
					</div>
					<div class="flex items-center space-x-2">
						<button class="px-3 py-1 rounded-md bg-gray-100 text-sm" (click)="closeDetail()">Close</button>
					</div>
				</div>

				<div class="mt-4 overflow-auto flex-1">
					<div class="prose max-w-none text-sm text-gray-700" [innerHTML]="selectedReport.content"></div>

					<div *ngIf="selectedReport.replyAt" class="mt-6 p-4 bg-green-50 rounded-md border border-green-100">
						<div class="text-sm text-gray-700 font-medium">Reply</div>
						<div class="text-sm text-gray-600 mt-1">{{ selectedReport.replyContent }}</div>
						<div class="text-xs text-gray-400 mt-2">By: {{ selectedReport.replyBy }} • {{ selectedReport.replyAt | date:'short' }}</div>
					</div>
				</div>

				<div class="mt-4">
					<div *ngIf="canReply && !selectedReport.replyAt" class="space-y-2">
						<label class="text-sm font-medium">Your reply</label>
						<textarea rows="4" class="w-full rounded-md border p-2 text-sm" [(ngModel)]="replyContent"></textarea>
						<div class="flex items-center justify-end space-x-2">
							<button class="px-3 py-1 rounded-md bg-gray-100 text-sm" (click)="closeDetail()">Cancel</button>
							<button class="px-3 py-1 rounded-md bg-green-600 text-white text-sm" (click)="submitReply()">Reply</button>
						</div>
					</div>
					<div *ngIf="!canReply" class="text-xs text-gray-500">You do not have permission to reply to reports.</div>
				</div>
			</div>
		</div>
	</div>

</div>
