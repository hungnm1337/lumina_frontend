<app-header></app-header>

<!-- Blog Hero Section -->
<div class="blog-hero">
  <div class="hero-content">
    <h1 class="hero-title">Articles TOEIC</h1>
    <p class="hero-subtitle">Discover knowledge, study tips and TOEIC exam experience from leading experts</p>
    
    <div class="hero-stats">
      <div class="stat-item">
        <i class="fas fa-file-alt"></i>
        <span>500+ articles</span>
      </div>
      <div class="stat-item">
        <i class="fas fa-users"></i>
        <span>50+ authors</span>
      </div>
      <div class="stat-item">
        <i class="fas fa-eye"></i>
        <span>1M+ reads</span>
      </div>
    </div>
  </div>
</div>

<!-- Search and Filter Section -->
<div class="search-filter-section">
  <div class="search-container">
    <div class="search-input-group">
      <input 
        type="text" 
        [(ngModel)]="searchQuery"
        placeholder="Search articles..." 
        class="search-input"
        (keyup.enter)="onSearch()"
      >
      <button class="search-btn" (click)="onSearch()">
        <i class="fas fa-search"></i>
      </button>
    </div>
    
    <div class="filter-group">
      <select [(ngModel)]="selectedCategory" class="filter-select">
        <option value="all">All topics</option>
        <option value="study-tips">Study tips</option>
        <option value="grammar">Grammar</option>
        <option value="vocabulary">Vocabulary</option>
        <option value="listening">Listening</option>
        <option value="reading">Reading</option>
      </select>
      
      <select [(ngModel)]="selectedSort" class="filter-select">
        <option value="newest">Newest</option>
        <option value="popular">Popular</option>
        <option value="trending">Trending</option>
      </select>
    </div>
  </div>
  
  <div class="category-buttons">
    <button 
      *ngFor="let category of filterCategories" 
      [class.active]="selectedCategory === category.id"
      (click)="onCategorySelect(category.id)"
      class="category-btn"
    >
      <i [class]="category.icon"></i>
      {{ category.name }}
    </button>
  </div>
</div>

<!-- Featured Articles Section -->
<div class="featured-section">
  <div class="section-header">
    <h2 class="section-title">Featured Articles</h2>
    <p class="section-subtitle">The most read and shared articles</p>
  </div>
  
  <div class="articles-grid featured-grid" *ngIf="!isLoading">
    <div *ngFor="let article of featuredArticles" class="article-card featured-card" (click)="goToArticleDetail(article.articleId)">
      <div class="card-header">
        <div class="card-tags">
          <span class="tag featured-tag">Featured</span>
          <span [class]="getStatusBadgeClass(getArticleProgress(article.articleId).status)">
            {{ getStatusText(getArticleProgress(article.articleId).status) }}
          </span>
        </div>
      </div>
      
      <!-- Completion icon -->
      <div class="completion-icon" *ngIf="getArticleProgress(article.articleId).status === 'completed'">
        <i class="fas fa-check-circle"></i>
      </div>
      
      <div class="card-image">
        <div class="image-placeholder" [style.background-color]="getCardBackgroundColor(article.articleId)">
          {{ article.title.substring(0, 20) }}
        </div>
      </div>
      
      <div class="card-content">
        <div class="card-meta">
          <span [class]="'category-tag ' + getCategoryColor(article.categoryName)">{{ article.categoryName }}</span>
          <span class="read-time">{{ getReadTime(article.summary) }}</span>
        </div>
        
        <h3 class="card-title">{{ article.title }}</h3>
        <p class="card-summary">{{ article.summary }}</p>
        
        <div class="card-author">
          <div [class]="'author-avatar ' + getAuthorAvatarColor(0)">
            {{ article.authorName.charAt(0).toUpperCase() }}
          </div>
          <div class="author-info">
            <span class="author-name">{{ article.authorName }}</span>
            <span class="publish-date">{{ formatDate(article.createdAt) }}</span>
          </div>
        </div>
        
        <div class="card-stats">
          <div class="stat">
            <i class="fas fa-heart"></i>
            <span>0</span>
          </div>
          <div class="stat">
            <i class="fas fa-comment"></i>
            <span>0</span>
          </div>
          <div class="stat">
            <i class="fas fa-eye"></i>
            <span>0</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Loading articles...</p>
  </div>
  
  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <p>{{ error }}</p>
    <button (click)="loadPublishedArticles()" class="retry-btn">Retry</button>
  </div>
</div>

<!-- Latest Articles Section -->
<div class="latest-section">
  <div class="section-header">
    <h2 class="section-title">Latest Articles</h2>
    <p class="section-subtitle">Latest TOEIC knowledge updates</p>
    <button 
      class="view-more-btn" 
      (click)="onViewMoreLatestArticles()"
      *ngIf="hasMoreArticles"
    >
      {{ showAllLatestArticles ? 'Collapse' : '+ View more' }}
    </button>
  </div>
  
  <div class="articles-grid latest-grid" *ngIf="!isLoading">
    <div *ngFor="let article of latestArticles" class="article-card latest-card" (click)="goToArticleDetail(article.articleId)">
      <div class="card-header">
        <div class="card-tags">
          <span class="tag trending-tag">New</span>
          <span [class]="getStatusBadgeClass(getArticleProgress(article.articleId).status)">
            {{ getStatusText(getArticleProgress(article.articleId).status) }}
          </span>
        </div>
      </div>
      
      <!-- Completion icon -->
      <div class="completion-icon" *ngIf="getArticleProgress(article.articleId).status === 'completed'">
        <i class="fas fa-check-circle"></i>
      </div>
      
      <div class="card-image">
        <div class="image-placeholder" [style.background-color]="getCardBackgroundColor(article.articleId)">
          {{ article.title.substring(0, 20) }}
        </div>
      </div>
      
      <div class="card-content">
        <div class="card-meta">
          <span [class]="'category-tag ' + getCategoryColor(article.categoryName)">{{ article.categoryName }}</span>
          <span class="read-time">{{ getReadTime(article.summary) }}</span>
        </div>
        
        <h3 class="card-title">{{ article.title }}</h3>
        <p class="card-summary">{{ article.summary }}</p>
        
        <div class="card-author">
          <div [class]="'author-avatar ' + getAuthorAvatarColor(0)">
            {{ article.authorName.charAt(0).toUpperCase() }}
          </div>
          <div class="author-info">
            <span class="author-name">{{ article.authorName }}</span>
            <span class="publish-date">{{ formatDate(article.createdAt) }}</span>
          </div>
        </div>
        
        <div class="card-stats">
          <div class="stat">
            <i class="fas fa-heart"></i>
            <span>0</span>
          </div>
          <div class="stat">
            <i class="fas fa-comment"></i>
            <span>0</span>
          </div>
          <div class="stat">
            <i class="fas fa-eye"></i>
            <span>0</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div class="pagination-container" *ngIf="showAllLatestArticles && totalPages > 1 && !isLoading">
    <div class="pagination">
      <button 
        class="pagination-btn prev-btn" 
        (click)="previousPage()"
        [disabled]="currentPage === 1"
        [class.disabled]="currentPage === 1"
      >
        <i class="fas fa-chevron-left"></i>
        <span>Previous</span>
      </button>
      
      <div class="pagination-numbers">
        <button 
          *ngIf="currentPage > 3"
          class="pagination-number"
          (click)="goToPage(1)"
        >
          1
        </button>
        <span *ngIf="currentPage > 4" class="pagination-ellipsis">...</span>
        
        <button 
          *ngFor="let page of getPageNumbers()"
          class="pagination-number"
          [class.active]="currentPage === page"
          (click)="goToPage(page)"
        >
          {{ page }}
        </button>
        
        <span *ngIf="currentPage < totalPages - 3" class="pagination-ellipsis">...</span>
        <button 
          *ngIf="currentPage < totalPages - 2"
          class="pagination-number"
          (click)="goToPage(totalPages)"
        >
          {{ totalPages }}
        </button>
      </div>
      
      <button 
        class="pagination-btn next-btn" 
        (click)="nextPage()"
        [disabled]="currentPage === totalPages"
        [class.disabled]="currentPage === totalPages"
      >
        <span>Next</span>
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
    
    <div class="pagination-info">
      Page {{ currentPage }} / {{ totalPages }} ({{ publishedArticles.length }} articles)
    </div>
  </div>
</div>

<!-- Featured Authors Section -->
<div class="authors-section">
  <div class="section-header">
    <h2 class="section-title">Featured Authors</h2>
    <p class="section-subtitle">Leading TOEIC experts</p>
  </div>
  
  <div class="authors-grid">
    <div *ngFor="let author of featuredAuthors" class="author-card">
      <div [class]="'author-avatar ' + author.avatarColor">
        {{ author.avatar }}
      </div>
      <h3 class="author-name">{{ author.name }}</h3>
      <p class="author-expertise">{{ author.expertise }}</p>
      <div class="author-stats">
        <span class="articles-count">{{ author.articlesCount }} articles</span>
        <span class="followers-count">{{ author.followers }} followers</span>
      </div>
      <button 
        [class]="author.isFollowing ? 'follow-btn following' : 'follow-btn'"
        (click)="onFollowAuthor(author.id)"
      >
        {{ author.isFollowing ? 'Following' : '+ Follow' }}
      </button>
    </div>
  </div>
</div>



