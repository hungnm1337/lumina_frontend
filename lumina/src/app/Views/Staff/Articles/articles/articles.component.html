<div class="articles-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">B√†i vi·∫øt ki·∫øn th·ª©c</h1>
      <p class="page-subtitle">T·∫°o n·ªôi dung h·ªçc t·∫≠p cho t·ª´ng k·ªπ nƒÉng</p>
    </div>
    <button class="btn-primary" (click)="openModal()">
      <i class="fas fa-plus"></i>
      T·∫°o b√†i vi·∫øt m·ªõi
    </button>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="search-box">
      <i class="fas fa-search"></i>
      <input 
        type="text" 
        placeholder="T√¨m ki·∫øm b√†i vi·∫øt..." 
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
      >
    </div>
    
    <div class="filter-group">
      <select [(ngModel)]="selectedCategory" (change)="onCategoryChange()">
        <option value="">T·∫•t c·∫£ danh m·ª•c</option>
        <option *ngFor="let category of categories" [value]="category">
          {{ category }}
        </option>
      </select>
      
      <select [(ngModel)]="selectedStatus" (change)="onStatusChange()">
        <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
        <option value="published">ƒê√£ xu·∫•t b·∫£n</option>
        <option value="draft">B·∫£n nh√°p</option>
        <option value="pending">Ch·ªù duy·ªát</option>
      </select>
    </div>
  </div>

  <!-- Articles Grid -->
  <div class="articles-grid">
    <div class="article-card" *ngFor="let article of filteredArticles">
      <div class="article-status">
        <span [class]="getStatusClass(article.status)">
          {{ getStatusText(article.status) }}
        </span>
      </div>
      
      <div class="article-content">
        <h3 class="article-title">{{ article.title }}</h3>
        <p class="article-excerpt">{{ article.summary }}</p>
        
        <div class="article-meta">
          <div class="meta-item">
            <i class="fas fa-tag"></i>
            <span>{{ article.category }}</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-calendar"></i>
            <span>{{ article.publishDate }}</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-eye"></i>
            <span>{{ article.views | number }} l∆∞·ª£t xem</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-heart"></i>
            <span>{{ article.likes | number }} l∆∞·ª£t th√≠ch</span>
          </div>
        </div>
        
        <div class="author-info">
          <div class="author-avatar">
            <i class="fas fa-user"></i>
          </div>
          <div class="author-details">
            <span class="author-name">{{ article.author }}</span>
            <span class="author-role">{{ article.authorRole }}</span>
          </div>
        </div>
      </div>
      
      <div class="article-actions">
        <button class="btn-action btn-edit" (click)="openModal(article)">
          <i class="fas fa-edit"></i>
        </button>
        <button 
          class="btn-action btn-publish" 
          *ngIf="article.status !== 'published'"
          (click)="publishArticle(article.id)"
        >
          <i class="fas fa-upload"></i>
        </button>
        <button class="btn-action btn-delete" (click)="deleteArticle(article.id)">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="filteredArticles.length === 0">
    <i class="fas fa-file-alt"></i>
    <h3>Kh√¥ng t√¨m th·∫•y b√†i vi·∫øt n√†o</h3>
    <p>H√£y th·ª≠ thay ƒë·ªïi b·ªô l·ªçc ho·∫∑c t·∫°o b√†i vi·∫øt m·ªõi</p>
  </div>
</div>

<!-- Modal - Gi·ªëng y h·ªát form trong ·∫£nh -->
<div class="modal-overlay" *ngIf="isModalOpen" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-header-content">
        <div class="modal-icon">
          <i class="fas fa-edit"></i>
        </div>
        <div class="modal-title-section">
          <h2>{{ editingArticle ? 'Ch·ªânh s·ª≠a b√†i vi·∫øt' : 'T·∫°o b√†i vi·∫øt m·ªõi' }}</h2>
          <p>Nh·∫•p n·ªôi dung v√† ƒë·ªãnh d·∫°ng theo t·ª´ng section</p>
        </div>
      </div>
      <button class="btn-close" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <form [formGroup]="articleForm" (ngSubmit)="saveArticle()" class="modal-form">
      <!-- Row 1: Danh m·ª•c v√† Tr·∫°ng th√°i -->
      <div class="form-row">
        <div class="form-group">
          <label for="category">Danh m·ª•c</label>
          <select id="category" formControlName="category">
            <option value="">Ch·ªçn danh m·ª•c</option>
            <option *ngFor="let category of categories" [value]="category">
              {{ category }}
            </option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="status">Tr·∫°ng th√°i</label>
          <select id="status" formControlName="status">
            <option value="draft">üìù B·∫£n nh√°p</option>
            <option value="pending">‚è≥ Ch·ªù duy·ªát</option>
            <option value="published">‚úÖ ƒê√£ xu·∫•t b·∫£n</option>
          </select>
        </div>
      </div>
      
      <!-- Ti√™u ƒë·ªÅ -->
      <div class="form-group">
        <label for="title">Ti√™u ƒë·ªÅ</label>
        <input 
          type="text" 
          id="title"
          formControlName="title"
          placeholder="VD: 10 m·∫πo ƒë·∫°t 900+ TOEIC"
        >
        <div class="error-message" *ngIf="articleForm.get('title')?.errors?.['required'] && articleForm.get('title')?.touched">
          Ti√™u ƒë·ªÅ l√† b·∫Øt bu·ªôc
        </div>
        <div class="error-message" *ngIf="articleForm.get('title')?.errors?.['minlength'] && articleForm.get('title')?.touched">
          Ti√™u ƒë·ªÅ ph·∫£i c√≥ √≠t nh·∫•t 5 k√Ω t·ª±
        </div>
      </div>
      
      <!-- T√≥m t·∫Øt -->
      <div class="form-group">
        <label for="summary">T√≥m t·∫Øt</label>
        <textarea 
          id="summary"
          formControlName="summary"
          rows="3"
          placeholder="Nh·∫≠p ƒëo·∫°n m√¥ t·∫£/t√≥m t·∫Øt..."
        ></textarea>
        <div class="error-message" *ngIf="articleForm.get('summary')?.errors?.['required'] && articleForm.get('summary')?.touched">
          T√≥m t·∫Øt l√† b·∫Øt bu·ªôc
        </div>
        <div class="error-message" *ngIf="articleForm.get('summary')?.errors?.['minlength'] && articleForm.get('summary')?.touched">
          T√≥m t·∫Øt ph·∫£i c√≥ √≠t nh·∫•t 20 k√Ω t·ª±
        </div>
      </div>
      
      <!-- C√°c ph·∫ßn n·ªôi dung -->
      <div class="form-group">
        <label>C√°c ph·∫ßn n·ªôi dung</label>
        
        <div formArrayName="sections">
          <div *ngFor="let section of sections.controls; let i = index" 
               [formGroupName]="i" 
               class="section-item">
            
            <div class="section-header">
              <div class="section-type-group">
                <label>Lo·∫°i ph·∫ßn</label>
                <select formControlName="type">
                  <option *ngFor="let type of sectionTypes" [value]="type.value">
                    {{ type.label }}
                  </option>
                </select>
              </div>
              
              <div class="section-content-group">
                <label>N·ªôi dung</label>
                <textarea 
                  formControlName="content"
                  rows="3"
                  placeholder="Nh·∫≠p n·ªôi dung..."
                ></textarea>
              </div>
            </div>
            
            <div class="section-controls">
              <button type="button" class="btn-control btn-up" (click)="moveSectionUp(i)" [disabled]="i === 0">
                <i class="fas fa-arrow-up"></i>
              </button>
              <button type="button" class="btn-control btn-down" (click)="moveSectionDown(i)" [disabled]="i === sections.length - 1">
                <i class="fas fa-arrow-down"></i>
              </button>
              <button type="button" class="btn-control btn-remove" (click)="removeSection(i)">
                <i class="fas fa-trash text-red"></i> X√≥a
              </button>
            </div>
          </div>
        </div>
        
        <button type="button" class="btn-add-section" (click)="addSection()">
          <i class="fas fa-plus"></i> Th√™m ph·∫ßn
        </button>
      </div>
      
      <!-- Tags -->
      <div class="form-group">
        <label for="tags">Tags</label>
        <input 
          type="text" 
          id="tags"
          formControlName="tags"
          placeholder="VD: TOEIC, Listening, 900 ƒëi·ªÉm"
        >
        <small class="form-hint">Ph√¢n c√°ch c√°c tag b·∫±ng d·∫•u ph·∫©y</small>
      </div>
      
      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="closeModal()">
          L∆∞u nh√°p
        </button>
        <button type="submit" class="btn-primary" [disabled]="!articleForm.valid">
          {{ editingArticle ? 'C·∫≠p nh·∫≠t' : 'L∆∞u & Xu·∫•t b·∫£n' }}
        </button>
      </div>
    </form>
  </div>
</div>
