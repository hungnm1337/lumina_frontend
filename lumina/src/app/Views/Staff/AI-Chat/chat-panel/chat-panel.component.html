<div class="chat-panel">
  <!-- <div class="panel-header">
    <h2>üí¨ AI Exam Generator</h2>
  </div> -->

  <div #messagesContainer class="messages-container">
    <ng-container *ngIf="messages?.length; else empty">
      <div *ngFor="let message of messages" class="message-wrapper">
        <app-message-item [message]="message"></app-message-item>
        
        <!-- N√∫t xem preview n·∫øu message c√≥ previewId -->
        <div class="preview-action" *ngIf="message.previewId && message.role === 'assistant'">
          <button class="view-preview-btn" (click)="onPreviewClick(message.previewId)">
            <i class="fas fa-eye"></i>
            Xem l·∫°i ƒë·ªÅ thi n√†y
          </button>
        </div>
      </div>
    </ng-container>

    <ng-template #empty>
      <div class="empty-placeholder">
        <i class="fas fa-comments" style="font-size: 48px; color: #cbd5e1; margin-bottom: 16px;"></i>
        <p style="color: #94a3b8;">Ch∆∞a c√≥ tin nh·∫Øn</p>
      </div>
    </ng-template>

    <div class="loading-indicator" *ngIf="isLoading">
      <div class="typing-dots">
        <span></span><span></span><span></span>
      </div>
    </div>
  </div>

  <div class="input-container">
    <textarea
      [(ngModel)]="newMessage"
      placeholder="Vd: T·∫°o 5 c√¢u Reading Part 5 v·ªÅ gi·ªõi t·ª´"
      (keydown.enter)="onEnter($event)"
      rows="1"></textarea>

    <button (click)="sendMessage()" [disabled]="!newMessage.trim() || isLoading">
      <i class="fas fa-paper-plane"></i>
    </button>
  </div>
</div>