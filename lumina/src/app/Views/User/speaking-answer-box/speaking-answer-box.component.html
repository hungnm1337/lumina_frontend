<div class="speaking-answer-container">
  <!-- INFORMATION PHASE (Part 4 Q8 only) -->
  @if (timerService.phase$ | async; as phase) { @if (phase === 'information') {
  <div class="text-center py-8">
    <div class="mb-4">
      <i class="fas fa-info-circle text-blue-600 text-6xl"></i>
    </div>

    <h3 class="text-2xl font-semibold text-gray-800 mb-2">
      ğŸ“‹ Äá»c thÃ´ng tin sau Ä‘Ã¢y
    </h3>

    <div class="text-5xl font-mono font-bold text-blue-600 mb-4">
      {{ timerService.infoTimeRemaining$ | async }}s
    </div>

    <div class="w-full bg-gray-200 rounded-full h-3 mb-4">
      <div
        class="bg-blue-600 h-3 rounded-full transition-all duration-300"
        [style.width.%]="
          (((timerService.infoTimeRemaining$ | async) ?? 0) / infoReadTime) *
          100
        "
      ></div>
    </div>

    <div
      class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md text-blue-700 text-sm"
    >
      <i class="fas fa-clock mr-1"></i>
      Báº£ng thÃ´ng tin sáº½ hiá»ƒn thá»‹ trong suá»‘t Part 4
    </div>
  </div>
  }

  <!-- PREPARATION PHASE -->
  @if (phase === 'preparation') {
  <div class="text-center py-8">
    <div class="mb-4">
      <i class="fas fa-book-reader text-blue-600 text-6xl"></i>
    </div>

    <h3 class="text-2xl font-semibold text-gray-800 mb-2">
      Thá»i gian chuáº©n bá»‹
    </h3>

    <div class="text-6xl font-mono font-bold text-blue-600 mb-4">
      {{ timerService.prepTimeRemaining$ | async }}s
    </div>

    <p class="text-gray-600 mb-4">
      Äá»c ká»¹ cÃ¢u há»i. Ghi Ã¢m sáº½ tá»± Ä‘á»™ng báº¯t Ä‘áº§u khi háº¿t giá».
    </p>

    <!-- Progress bar -->
    <div class="w-full bg-gray-200 rounded-full h-3">
      <div
        class="bg-blue-600 h-3 rounded-full transition-all duration-300"
        [style.width.%]="
          (((timerService.prepTimeRemaining$ | async) ?? 0) / preparationTime) *
          100
        "
      ></div>
    </div>

    <div
      class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md text-yellow-700 text-sm"
    >
      <i class="fas fa-lock mr-1"></i>
      KhÃ´ng thá»ƒ báº¯t Ä‘áº§u ghi Ã¢m thá»§ cÃ´ng - há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng báº¯t Ä‘áº§u
    </div>
  </div>
  }

  <!-- RECORDING PHASE -->
  @if (phase === 'recording') {
  <div class="text-center py-8">
    <div class="mb-4">
      <div class="inline-block relative">
        <i class="fas fa-microphone text-red-600 text-6xl animate-pulse"></i>
        <span class="absolute -top-1 -right-1 flex h-5 w-5">
          <span
            class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"
          ></span>
          <span
            class="relative inline-flex rounded-full h-5 w-5 bg-red-500"
          ></span>
        </span>
      </div>
    </div>

    <h3 class="text-2xl font-semibold text-gray-800 mb-2">Äang ghi Ã¢m...</h3>

    <div class="text-6xl font-mono font-bold text-red-600 mb-2">
      {{ timerService.recordTimeRemaining$ | async }}s
    </div>

    <p class="text-sm text-gray-600 mb-4">Thá»i gian cÃ²n láº¡i Ä‘á»ƒ tráº£ lá»i</p>

    <!-- Progress bar -->
    <div class="w-full bg-gray-200 rounded-full h-3 mb-4">
      <div
        class="bg-red-600 h-3 rounded-full transition-all duration-300"
        [style.width.%]="
          ((recordingTime -
            ((timerService.recordTimeRemaining$ | async) ?? recordingTime)) /
            recordingTime) *
          100
        "
      ></div>
    </div>

    <div
      class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md text-blue-700 text-sm"
    >
      <i class="fas fa-info-circle mr-1"></i>
      Tá»± Ä‘á»™ng dá»«ng vÃ  chuyá»ƒn cÃ¢u tiáº¿p theo khi háº¿t thá»i gian
    </div>
  </div>
  } }

  <!-- PROCESSING - Äang cháº¥m Ä‘iá»ƒm (chá»‰ hiá»‡n á»Ÿ cÃ¢u cuá»‘i) -->
  @if (isProcessing && isLastQuestion) {
  <div class="text-center py-8">
    <div class="mb-4">
      <svg
        class="animate-spin h-16 w-16 mx-auto text-blue-600"
        fill="none"
        viewBox="0 0 24 24"
      >
        <circle
          class="opacity-25"
          cx="12"
          cy="12"
          r="10"
          stroke="currentColor"
          stroke-width="4"
        ></circle>
        <path
          class="opacity-75"
          fill="currentColor"
          d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
        ></path>
      </svg>
    </div>

    <h3 class="text-lg font-semibold text-gray-800 mb-2">Äang cháº¥m Ä‘iá»ƒm...</h3>
    <p class="text-sm text-gray-600">Vui lÃ²ng Ä‘á»£i trong giÃ¢y lÃ¡t</p>

    <div
      class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md text-yellow-700 text-sm"
    >
      <i class="fas fa-hourglass-half mr-1"></i>
      Há»‡ thá»‘ng Ä‘ang phÃ¢n tÃ­ch phÃ¡t Ã¢m, ngá»¯ phÃ¡p vÃ  ná»™i dung cá»§a báº¡n
    </div>
  </div>
  }

  <!-- SUBMITTED - ÄÃ£ ná»™p bÃ i, Ä‘ang chá» káº¿t quáº£ (chá»‰ hiá»‡n á»Ÿ cÃ¢u cuá»‘i) -->
  @if (isSubmitted && !result && isLastQuestion) {
  <div class="text-center py-8">
    <div class="mb-4">
      <i class="fas fa-paper-plane text-blue-600 text-6xl"></i>
    </div>

    <h3 class="text-lg font-semibold text-gray-800 mb-2">ÄÃ£ ná»™p bÃ i</h3>
    <p class="text-sm text-gray-600">Há»‡ thá»‘ng Ä‘ang cháº¥m Ä‘iá»ƒm trong ná»n</p>

    <div
      class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md text-blue-700 text-sm"
    >
      <i class="fas fa-info-circle mr-1"></i>
      Káº¿t quáº£ sáº½ hiá»ƒn thá»‹ khi hoÃ n táº¥t.
    </div>
  </div>
  }

  <!-- SUBMITTED with Result - ÄÃ£ cháº¥m xong (chá»‰ hiá»‡n á»Ÿ cÃ¢u cuá»‘i) -->
  @if (isSubmitted && result && isLastQuestion) {
  <div class="py-6">
    <div class="mb-4 p-4 bg-green-50 border-2 border-green-300 rounded-lg">
      <div class="text-center">
        <i class="fas fa-check-circle text-green-600 text-5xl mb-3"></i>
        <h3 class="text-xl font-bold text-green-800 mb-2">
          ÄÃ£ cháº¥m Ä‘iá»ƒm xong cho cÃ¢u nÃ y!
        </h3>
        <p class="text-gray-700 mb-3">
          CÃ¢u tráº£ lá»i cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c cháº¥m Ä‘iá»ƒm thÃ nh cÃ´ng.
        </p>
      </div>
    </div>
  </div>
  }

  <!-- ERROR State -->
  @if (isError && errorMessage) {
  <div class="text-center py-8">
    <div class="mb-4">
      <i class="fas fa-exclamation-triangle text-red-600 text-6xl"></i>
    </div>

    <h3 class="text-xl font-semibold text-red-800 mb-2">ÄÃ£ xáº£y ra lá»—i</h3>

    <div
      class="mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700"
    >
      {{ errorMessage }}
    </div>

    <p class="text-sm text-gray-600">
      Vui lÃ²ng liÃªn há»‡ há»— trá»£ náº¿u lá»—i váº«n tiáº¿p tá»¥c.
    </p>
  </div>
  }
</div>
