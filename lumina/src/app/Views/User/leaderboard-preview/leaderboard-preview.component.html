<section class="py-20 bg-gradient-to-br from-gray-50 to-blue-50" *ngIf="currentSeason">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

    <!-- Header -->
    <div class="text-center mb-12">
      <h2 class="text-4xl font-bold text-gray-900 mb-4">
        <i class="fas fa-trophy text-yellow-500 mr-3"></i>
        Bảng Xếp Hạng
      </h2>
      <p class="text-xl text-gray-600">Những người chơi xuất sắc nhất mùa giải hiện tại</p>
    </div>

    <!-- Current Season Banner -->
    <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 mb-8 text-white shadow-xl">
      <div class="flex flex-col md:flex-row justify-between items-center gap-4">
        <div>
          <div class="text-sm text-blue-100 mb-1">Mùa giải hiện tại</div>
          <h3 class="text-2xl font-bold">{{ currentSeason.seasonName || 'Season ' + currentSeason.seasonNumber }}</h3>
          <div class="flex flex-wrap gap-3 mt-2 text-sm">
            <span class="flex items-center gap-1">
              <i class="fas fa-calendar"></i>
              {{ leaderboardService.formatDate(currentSeason.startDate) }} - {{ leaderboardService.formatDate(currentSeason.endDate) }}
            </span>
            <span class="flex items-center gap-1">
              <i class="fas fa-users"></i>
              {{ currentSeason.totalParticipants }} người tham gia
            </span>
          </div>
        </div>

      </div>
    </div>

    <!-- Loading -->
    <div class="text-center py-12" *ngIf="loading">
      <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"></div>
      <p class="mt-4 text-gray-600">Đang tải...</p>
    </div>

    <!-- Top 3 Players -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8" *ngIf="!loading && top3.length > 0">

      <!-- Rank 2 -->
      <div class="order-2 md:order-1" *ngIf="top3.length >= 2">
        <div class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border-4 border-gray-300 mt-8">
          <div class="text-center">
            <div class="relative inline-block mb-4">
              <img [src]="top3[1].avatarUrl || '/assets/default-avatar.png'"
                   alt="avatar"
                   class="w-24 h-24 rounded-full object-cover border-4 border-gray-300 shadow-lg">
              <div class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 bg-gradient-to-br from-gray-300 to-gray-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg shadow-lg">
                2
              </div>
            </div>
            <h4 class="text-xl font-bold text-gray-900 mb-2">{{ top3[1].fullName }}</h4>
            <div class="mb-2" *ngIf="top3[1].estimatedTOEICScore">
              <div class="text-sm text-gray-600">TOEIC Ước Tính</div>
              <div class="text-lg font-bold text-gray-900">{{ top3[1].estimatedTOEICScore }}</div>
              <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold mt-1"
                    [ngClass]="leaderboardService.getTOEICLevelColor(top3[1].toeicLevel)">
                {{ leaderboardService.getTOEICLevelText(top3[1].toeicLevel) }}
              </span>
            </div>
            <div class="inline-flex items-center justify-center px-4 py-2 rounded-full bg-blue-100 text-blue-700 font-bold text-lg">
              {{ top3[1].score }} điểm
            </div>
          </div>
        </div>
      </div>

      <!-- Rank 1 (Winner) -->
      <div class="order-1 md:order-2" *ngIf="top3.length >= 1">
        <div class="bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-2xl p-6 shadow-2xl hover:shadow-3xl transition-all duration-300 transform hover:-translate-y-2 relative overflow-hidden">
          <!-- Crown decoration -->
          <div class="absolute top-0 right-0 text-yellow-200 text-6xl opacity-20">
            <i class="fas fa-crown"></i>
          </div>
          <div class="text-center relative z-10">
            <div class="relative inline-block mb-4">
              <img [src]="top3[0].avatarUrl || '/assets/default-avatar.png'"
                   alt="avatar"
                   class="w-28 h-28 rounded-full object-cover border-4 border-white shadow-2xl">
              <div class="absolute -top-4 left-1/2 transform -translate-x-1/2">
                <i class="fas fa-crown text-yellow-200 text-3xl"></i>
              </div>
              <div class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 bg-white text-yellow-600 w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl shadow-lg">
                1
              </div>
            </div>
            <h4 class="text-2xl font-bold text-white mb-2">{{ top3[0].fullName }}</h4>
            <div class="mb-3" *ngIf="top3[0].estimatedTOEICScore">
              <div class="text-sm text-yellow-100">TOEIC Ước Tính</div>
              <div class="text-xl font-bold text-white">{{ top3[0].estimatedTOEICScore }}</div>
              <span class="inline-flex items-center px-3 py-1 rounded-full bg-white text-xs font-semibold mt-1"
                    [ngClass]="leaderboardService.getTOEICLevelColor(top3[0].toeicLevel)">
                {{ leaderboardService.getTOEICLevelText(top3[0].toeicLevel) }}
              </span>
            </div>
            <div class="inline-flex items-center justify-center px-6 py-3 rounded-full bg-white text-yellow-700 font-bold text-xl shadow-lg">
              {{ top3[0].score }} điểm
            </div>
          </div>
        </div>
      </div>

      <!-- Rank 3 -->
      <div class="order-3" *ngIf="top3.length >= 3">
        <div class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border-4 border-orange-400 mt-8">
          <div class="text-center">
            <div class="relative inline-block mb-4">
              <img [src]="top3[2].avatarUrl || '/assets/default-avatar.png'"
                   alt="avatar"
                   class="w-24 h-24 rounded-full object-cover border-4 border-orange-400 shadow-lg">
              <div class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 bg-gradient-to-br from-orange-400 to-orange-600 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg shadow-lg">
                3
              </div>
            </div>
            <h4 class="text-xl font-bold text-gray-900 mb-2">{{ top3[2].fullName }}</h4>
            <div class="mb-2" *ngIf="top3[2].estimatedTOEICScore">
              <div class="text-sm text-gray-600">TOEIC Ước Tính</div>
              <div class="text-lg font-bold text-gray-900">{{ top3[2].estimatedTOEICScore }}</div>
              <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold mt-1"
                    [ngClass]="leaderboardService.getTOEICLevelColor(top3[2].toeicLevel)">
                {{ leaderboardService.getTOEICLevelText(top3[2].toeicLevel) }}
              </span>
            </div>
            <div class="inline-flex items-center justify-center px-4 py-2 rounded-full bg-blue-100 text-blue-700 font-bold text-lg">
              {{ top3[2].score }} điểm
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- View All Button -->
    <div class="text-center" *ngIf="!loading && top3.length > 0">
      <button (click)="viewAll()" class="inline-flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300">
        <span>Xem tất cả bảng xếp hạng</span>
        <i class="fas fa-arrow-right"></i>
      </button>
    </div>

    <!-- Empty State -->
    <div class="text-center py-12 bg-white rounded-2xl shadow-lg" *ngIf="!loading && top3.length === 0">
      <i class="fas fa-trophy text-gray-300 text-6xl mb-4"></i>
      <h3 class="text-2xl font-bold text-gray-700 mb-2">Chưa có dữ liệu xếp hạng</h3>
      <p class="text-gray-500">Hãy bắt đầu làm bài thi để tham gia bảng xếp hạng!</p>
    </div>

  </div>
</section>
